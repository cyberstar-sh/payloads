# Minimal GUI Cybersecurity Toolkit Installer
# Author: Generated by ChatGPT - Terminal-focused CommandoVM-style setup

Set-ExecutionPolicy Bypass -Scope Process -Force
[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.SecurityProtocolType]::Tls12

# Install Chocolatey if not already present
if (!(Get-Command choco.exe -ErrorAction SilentlyContinue)) {
    Write-Host "[*] Installing Chocolatey..."
    Invoke-Expression ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
}

# Create Tools Directory on Desktop
$desktop = [Environment]::GetFolderPath("Desktop")
$toolsRoot = Join-Path $desktop "Tools"
New-Item -ItemType Directory -Force -Path $toolsRoot | Out-Null

# Define categories and tools (CLIs only)
$toolMap = @{
    "Networking" = @("nmap", "nping", "fping", "tcping", "netcat.portable", "curl", "wget")
    "PostExploitation" = @()
    "Recon" = @("whois", "dnsutils", "sqlite", "masscan", "sublist3r", "amass")
    "PasswordAttacks" = @("hashcat", "john", "lazagne.portable", "hydra")
    "Forensics" = @("plaso", "logparser", "winlogbeat")
    "Utilities" = @("7zip.commandline", "python", "git", "sysinternals", "openssh", "jq", "procmon")
}

# CLI Tools to Install
foreach ($category in $toolMap.Keys) {
    $path = Join-Path $toolsRoot $category
    New-Item -ItemType Directory -Force -Path $path | Out-Null

    foreach ($tool in $toolMap[$category]) {
        Write-Host "[*] Installing $tool to $category..."
        choco install $tool -y
    }
}

# Git clone-based red team repos (CLIs only)
$gitTools = @{
    "PostExploitation" = @(
        "https://github.com/PowerShellMafia/PowerSploit.git",
        "https://github.com/samratashok/nishang.git",
        "https://github.com/GhostPack/Seatbelt.git",
        "https://github.com/GhostPack/SharpUp.git",
        "https://github.com/gentilkiwi/mimikatz.git"
    )
    "Recon" = @(
        "https://github.com/PowerShellEmpire/PowerTools.git",
        "https://github.com/BloodHoundAD/BloodHound.git"
    )
    "PasswordAttacks" = @(
        "https://github.com/AlessandroZ/LaZagne.git"
    )
}

foreach ($category in $gitTools.Keys) {
    $catPath = Join-Path $toolsRoot $category
    foreach ($repo in $gitTools[$category]) {
        $name = ($repo.Split("/")[-1]).Replace(".git", "")
        $dest = Join-Path $catPath $name
        Write-Host "[*] Cloning $name into $category..."
        git clone $repo $dest
    }
}

# Optional: install Python tools (headless)
Write-Host "[*] Installing Python packages..."
python -m pip install --upgrade pip
pip install impacket pycryptodome flask requests

Write-Host "[+] Toolkit installed to $toolsRoot"